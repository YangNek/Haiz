<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Trang Web T√¨nh Y√™u</title>
  <style>
    /* ===== Reset & c∆° b·∫£n ===== */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background: #fff; overflow-x: hidden; }
    button { cursor: pointer; }

    /* ===== M√ÄN H√åNH CH√ÄO ===== */
    .welcome-screen {
      width: 100%;
      height: 100vh;
      background: #ffe6f2;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: opacity 0.8s, visibility 0.8s;
    }
    .welcome-screen.hide { opacity: 0; visibility: hidden; }
    .welcome-box {
      background: #fff;
      padding: 20px 30px;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .welcome-box h2 { margin-bottom: 10px; color: #ff4081; }
    .avatar {
      width: 100px; height: 100px;
      border-radius: 50%;
      background: linear-gradient(45deg, #ff4081, #ffc0cb);
      margin: 0 auto 15px;
      border: 3px solid #ff4081;
    }
    .welcome-box input {
      width: 200px; padding: 8px; margin-bottom: 10px;
      border: 1px solid #ccc; border-radius: 5px;
      text-align: center;
    }
    .welcome-box button {
      background: #ff4081; color: #fff;
      padding: 10px 20px; border: none;
      border-radius: 5px; font-weight: bold;
    }
    .welcome-box button:hover { background: #e91e63; }

    /* ƒê∆∞·ªùng & xe van (CSS) */
    .road {
      width: 100%; height: 120px; background: #fff;
      margin-top: 20px; position: relative; overflow: hidden;
    }
    .line {
      position: absolute; top: 50%; left: 0;
      width: 100%; height: 2px; background: #666;
    }
    .van {
      position: absolute; bottom: 0; left: -150px;
      width: 120px; height: 60px; background: pink;
      border-radius: 10px 10px 20px 20px;
      animation: drive 6s linear infinite;
    }
    .van::before {
      content: "";
      position: absolute; width: 60px; height: 30px;
      background: pink; top: -30px; left: 10px;
      border-radius: 10px 10px 0 0;
    }
    .wheel {
      position: absolute; bottom: -10px;
      width: 20px; height: 20px;
      background: #333; border-radius: 50%;
    }
    .wheel:nth-child(2) { left: 15px; }
    .wheel:nth-child(3) { right: 15px; }
    @keyframes drive {
      0% { left: -150px; } 100% { left: 110%; }
    }

    /* Hi·ªáu ·ª©ng tr√°i tim bay tr√™n m√†n h√¨nh ch√†o */
    .heart {
      position: absolute;
      width: 30px; height: 30px;
      background: red; top: 80%;
      border-radius: 50% 50% 0 0;
      transform: rotate(-45deg);
      animation: floatUp 3s ease-in-out infinite;
    }
    .heart::before, .heart::after {
      content: "";
      position: absolute;
      width: 30px; height: 30px;
      background: red;
      border-radius: 50% 50% 0 0;
    }
    .heart::before { left: -15px; }
    .heart::after { top: -15px; left: 0; }
    @keyframes floatUp {
      0% { transform: translateY(0) rotate(-45deg); opacity: 1; }
      70% { transform: translateY(-50px) rotate(-45deg); }
      100% { transform: translateY(-80px) rotate(-45deg); opacity: 0; }
    }

    /* ===== M√ÄN H√åNH C√ÇU H·ªéI ===== */
    .question-screen {
      position: absolute;
      top: 0; left: 0;
      width: 100%; min-height: 100vh;
      background: #fff;
      display: none;
      flex-direction: column;
      align-items: center;
      padding-top: 20px;
      overflow-y: auto;
    }
    /* Thanh ti·∫øn ƒë·ªô + m√®o */
    .progress-container {
      width: 80%; max-width: 400px;
      height: 20px; background: #ddd;
      border-radius: 10px; margin: 20px auto;
      position: relative;
    }
    .progress {
      width: 0%; height: 100%;
      background: pink; border-radius: 10px;
      transition: width 0.5s;
    }
    .progress-percent {
      position: absolute; top: -25px; right: 10px;
      font-size: 14px; font-weight: bold;
    }
    .cat {
      position: absolute; left: 0; top: -20px;
      width: 30px; height: 30px;
      background: #aaa; border-radius: 50%;
      transition: left 0.5s;
    }
    .cat::before {
      content: "";
      position: absolute; width: 10px; height: 10px;
      background: #aaa; top: -6px; left: 0;
      transform: rotate(45deg); border-radius: 2px;
    }
    .cat::after {
      content: "";
      position: absolute; width: 10px; height: 10px;
      background: #aaa; top: -6px; right: 0;
      transform: rotate(-45deg); border-radius: 2px;
    }

    .question-box {
      background: #ffe6f2;
      width: 80%; max-width: 300px;
      margin: 20px auto; padding: 15px;
      border-radius: 10px;
      display: none;
      position: relative;
    }
    .question-box p { margin-bottom: 10px; }
    .question-box button {
      margin: 5px; padding: 8px 12px;
      border: none; border-radius: 5px;
      background: #ff4081; color: #fff;
    }
    .question-box button:hover { background: #e91e63; }
    /* Th√¥ng b√°o timeout (2s) */
    .timeout-message {
      color: #ff4081; font-style: italic;
      margin-top: 10px; display: none;
    }
    /* Th√¥ng b√°o khi ch·ªçn "Kh√¥ng" */
    .decline-message {
      color: #555; font-style: italic;
      margin-top: 10px; display: none;
    }

    /* Hoa: H√¨nh thoi (diamond) v·ªõi c√†nh */
    .flower {
      width: 100px; height: 140px;
      margin: 10px auto;
      position: relative;
    }
    .diamond {
      position: absolute; top: 0; left: 50%;
      width: 40px; height: 40px;
      background: red;
      transform: translateX(-50%) rotate(45deg);
      border: 2px solid #d60000;
    }
    .stem {
      position: absolute; top: 40px; left: 50%;
      width: 4px; height: 50px;
      background: green;
      transform: translateX(-50%);
    }

    /* C√¢y ƒë√†o v·ªõi hi·ªáu ·ª©ng tr√°i tim r∆°i */
    .cherry-tree {
      position: absolute; bottom: 0; right: 10%;
      width: 150px; height: 350px;
    }
    .trunk {
      position: absolute; bottom: 0; left: 60px;
      width: 30px; height: 150px;
      background: #8B4513; border-radius: 10px;
    }
    .blossom {
      position: absolute; bottom: 150px; left: 0;
      width: 150px; height: 100px;
      background: pink; border-radius: 80px 80px 0 0;
    }
    .faint-heart {
      position: absolute;
      width: 20px; height: 20px;
      background: red; opacity: 0.5;
      top: 10px; left: 50%;
      border-radius: 50% 50% 0 0;
      transform: translateX(-50%) rotate(-45deg);
      animation: faintFall 6s linear infinite;
    }
    @keyframes faintFall {
      0% { transform: translateX(-50%) translateY(0) rotate(-45deg); }
      100% { transform: translateX(-50%) translateY(300px) rotate(-45deg); opacity: 0; }
    }

    /* M√°y bay v·ªõi c√°nh (CSS) */
    .plane {
      position: absolute;
      top: 20px;
      right: -150px;
      width: 100px; height: 40px;
      background: #bbb;
      border-radius: 10px;
      display: none;
      transition: right 2s ease-in-out;
    }
    .plane::before {
      content: "";
      position: absolute; width: 30px; height: 10px;
      background: #bbb;
      top: 15px; left: -20px;
      border-radius: 5px;
    }
    .plane::after {
      content: "";
      position: absolute; width: 20px; height: 40px;
      background: #bbb;
      top: 0; right: -20px;
      border-radius: 0 5px 5px 0;
    }

    /* H·ªôp qu√† (vu√¥ng v·ª©c) */
    .box {
      position: absolute;
      top: 150px;
      left: 50%;
      transform: translateX(-50%);
      width: 50px; height: 50px;
      background: brown;
      border: 2px solid #8B0000;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
      display: none;
      cursor: pointer;
      animation: glow 1s infinite alternate;
    }
    @keyframes glow {
      from { box-shadow: 0 0 5px yellow; }
      to { box-shadow: 0 0 15px yellow; }
    }

    /* Falling hearts (m·ªói c√¢u "C√≥" t·∫°o 5 tr√°i tim r∆°i) */
    .falling-hearts-container {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      overflow: visible;
    }
    .falling-heart {
      position: absolute;
      width: 20px; height: 20px;
      background: red;
      border-radius: 50% 50% 0 0;
      transform: rotate(-45deg);
      animation: heartFall 3s ease-in forwards;
    }
    .falling-heart::before,
    .falling-heart::after {
      content: "";
      position: absolute;
      width: 20px; height: 20px;
      background: red;
      border-radius: 50% 50% 0 0;
    }
    .falling-heart::before { left: -10px; }
    .falling-heart::after { top: -10px; }
    @keyframes heartFall {
      0% { transform: translateY(0) rotate(-45deg); opacity: 1; }
      100% { transform: translateY(200px) rotate(-45deg); opacity: 0; }
    }
  </style>
</head>
<body>

  <!-- M√†n h√¨nh ch√†o -->
  <div class="welcome-screen" id="welcomeScreen">
    <div class="welcome-box">
      <div class="avatar"></div>
      <h2>Welcome</h2>
      <input type="text" id="nameInput" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n"/>
      <br/>
      <button onclick="startQuestions()">B·∫Øt ƒë·∫ßu</button>
    </div>
    <div class="road">
      <div class="line"></div>
      <div class="van">
        <div class="wheel"></div>
        <div class="wheel"></div>
      </div>
      <!-- Tr√°i tim bay ng·∫´u nhi√™n -->
      <div class="heart" style="left: 20%;"></div>
      <div class="heart" style="left: 40%;"></div>
      <div class="heart" style="left: 60%;"></div>
      <div class="heart" style="left: 80%;"></div>
    </div>
  </div>

  <!-- M√†n h√¨nh c√¢u h·ªèi -->
  <div class="question-screen" id="questionScreen">
    <!-- Thanh ti·∫øn ƒë·ªô -->
    <div class="progress-container">
      <div class="progress" id="progressBar"></div>
      <div class="progress-percent" id="progressPercent">0%</div>
      <div class="cat" id="catImg"></div>
    </div>

    <!-- Hoa (m·ªôt b√¥ng hoa v·∫Ω b·∫±ng CSS) -->
    <div class="flower" id="flower">
      <div class="diamond"></div>
      <div class="stem"></div>
    </div>

    <!-- C√°c h·ªôp c√¢u h·ªèi -->
    <div id="question1" class="question-box">
      <p id="q1Text">[T√™n], anh h·ªèi 1 c√¢u nh√©?</p>
      <button onclick="nextQuestion(2)">Ocii</button>
    </div>

    <div id="question2" class="question-box">
      <p>Em c√≥ y√™u anh kh√¥ng?</p>
      <button onclick="answerHandler('C√≥', 25, 3)">C√≥</button>
      <button onclick="answerHandler('Kh√¥ng', 0)">Kh√¥ng</button>
      <div class="timeout-message" id="timeoutMsg2"></div>
      <div class="decline-message" id="declineMsg2"></div>
    </div>

    <div id="question3" class="question-box">
      <p>Em c√≥ mu·ªën c∆∞·ªõi anh kh√¥ng?</p>
      <button onclick="answerHandler('C√≥', 25, 4)">C√≥</button>
      <button onclick="answerHandler('Kh√¥ng', 0)">Kh√¥ng</button>
      <div class="timeout-message" id="timeoutMsg3"></div>
      <div class="decline-message" id="declineMsg3"></div>
    </div>

    <div id="question4" class="question-box">
      <p>Em c√≥ nh·ªõ anh kh√¥ng?</p>
      <button onclick="answerHandler('C√≥', 25, 5)">C√≥</button>
      <button onclick="answerHandler('Kh√¥ng', 0)">Kh√¥ng</button>
      <div class="timeout-message" id="timeoutMsg4"></div>
      <div class="decline-message" id="declineMsg4"></div>
    </div>

    <div id="question5" class="question-box">
      <p>Em c√≥ ch·∫Øc mu·ªën anh l√†m ch·ªìng em kh√¥ng?</p>
      <button onclick="answerHandler('C√≥', 25, 6)">Ch·∫Øc</button>
      <button onclick="answerHandler('Kh√¥ng', 0)">Kh√¥ng</button>
      <div class="timeout-message" id="timeoutMsg5"></div>
      <div class="decline-message" id="declineMsg5"></div>
    </div>

    <!-- M√°y bay & H·ªôp qu√† -->
    <div class="plane" id="plane"></div>
    <div class="box" id="giftBox" onclick="openBox()">Qu√†</div>
    
    <!-- C√¢y ƒë√†o v·ªõi tr√°i tim r∆°i m·ªù, nhi·ªÅu t√°n -->
    <div class="cherry-tree">
      <div class="trunk"></div>
      <div class="blossom"></div>
      <div class="faint-heart" style="left: 40%; animation-delay: 0s;"></div>
      <div class="faint-heart" style="left: 60%; animation-delay: 2s;"></div>
    </div>

    <!-- Container cho falling hearts (m·ªói c√¢u "C√≥" t·∫°o ra 5 tr√°i tim r∆°i) -->
    <div class="falling-hearts-container" id="fallingHeartsContainer"></div>
  </div>

  <script>
    let welcomeScreen = document.getElementById("welcomeScreen");
    let questionScreen = document.getElementById("questionScreen");
    let nameInput = document.getElementById("nameInput");
    let q1Text = document.getElementById("q1Text");

    let progressBar = document.getElementById("progressBar");
    let progressPercent = document.getElementById("progressPercent");
    let catImg = document.getElementById("catImg");

    let plane = document.getElementById("plane");
    let giftBox = document.getElementById("giftBox");
    let fallingHeartsContainer = document.getElementById("fallingHeartsContainer");

    let currentProgress = 0;
    let timeoutHandle;

    // B·∫Øt ƒë·∫ßu chuy·ªÉn sang m√†n h√¨nh c√¢u h·ªèi
    function startQuestions() {
      let nameVal = nameInput.value.trim() || "Em";
      q1Text.textContent = nameVal + ", anh h·ªèi 1 c√¢u nh√©?";
      welcomeScreen.classList.add("hide");
      questionScreen.style.display = "flex";
      document.getElementById("question1").style.display = "block";
    }

    function nextQuestion(id) {
      hideTimeout();
      document.getElementById("question" + (id - 1)).style.display = "none";
      let nextQ = document.getElementById("question" + id);
      if (nextQ) {
        nextQ.style.display = "block";
        startTimeout(id);
      }
    }

    // X·ª≠ l√Ω tr·∫£ l·ªùi: n·∫øu "Kh√¥ng", hi·ªán th√¥ng b√°o; n·∫øu "C√≥", tƒÉng ti·∫øn ƒë·ªô v√† t·∫°o 5 falling hearts
    function answerHandler(answer, value, nextId) {
      hideTimeout();
      if (answer === "Kh√¥ng") {
        let parent = event.target.parentElement;
        Array.from(parent.querySelectorAll("button")).forEach(btn => btn.style.display = "none");
        let declineMsg = parent.querySelector(".decline-message");
        if (declineMsg) { 
          declineMsg.style.display = "block"; 
          declineMsg.textContent = "d·ªëi v√£i üòí"; 
        }
        setTimeout(() => { if(nextId) nextQuestion(nextId); }, 2000);
      } else {
        // T·∫°o 5 tr√°i tim r∆°i
        for (let i = 0; i < 5; i++) {
          createFallingHeart();
        }
        increaseProgress(value, nextId);
      }
    }

    // T·∫°o falling heart ƒë·ªông
    function createFallingHeart() {
      let heart = document.createElement("div");
      heart.className = "falling-heart";
      // V·ªã tr√≠ ng·∫´u nhi√™n theo chi·ªÅu ngang trong container
      heart.style.left = Math.random() * 100 + "%";
      fallingHeartsContainer.appendChild(heart);
      // X√≥a heart sau 3 gi√¢y
      setTimeout(() => { heart.remove(); }, 3000);
    }

    // TƒÉng thanh ti·∫øn ƒë·ªô
    function increaseProgress(value, nextId) {
      currentProgress += value;
      if (currentProgress >= 100) {
        currentProgress = 100;
        progressBar.style.width = "100%";
        progressPercent.textContent = "100%";
        catImg.style.left = "calc(100% - 30px)";
        setTimeout(showPlane, 1500);
      } else {
        progressBar.style.width = currentProgress + "%";
        progressPercent.textContent = currentProgress + "%";
        catImg.style.left = currentProgress + "%";
        if(nextId) nextQuestion(nextId);
      }
    }

    function hideTimeout() {
      if(timeoutHandle) clearTimeout(timeoutHandle);
    }

    // Timeout n·∫øu kh√¥ng tr·∫£ l·ªùi trong 2 gi√¢y
    function startTimeout(qId) {
      timeoutHandle = setTimeout(() => {
        let timeoutMsg = document.getElementById("timeoutMsg" + qId);
        if(timeoutMsg) { 
          timeoutMsg.style.display = "block"; 
          timeoutMsg.textContent = "∆° s trl l√¢u qu√° z·∫≠y, k th∆∞∆°ng a √† :(";
        }
      }, 2000);
    }

    // M√°y bay bay v√† sau 3 gi√¢y m·ªõi xu·∫•t hi·ªán h·ªôp qu√†
    function showPlane() {
      plane.style.display = "block";
      setTimeout(() => {
        plane.style.right = "110%";
        setTimeout(() => { giftBox.style.display = "block"; }, 3000);
      }, 500);
    }

    // M·ªü h·ªôp qu√†: ph√°t √¢m thanh v√† hi·ªÉn th·ªã th√¥ng b√°o y√™u th∆∞∆°ng
    function openBox() {
      let audio = new Audio("https://www.fesliyanstudios.com/play-mp3/387");
      audio.play();
      setTimeout(() => {
        alert(
          "Cu·ªôc s·ªëng th√¨ gi·ªëng cu·ªôc ƒë·ªùi, c√≤n anh th√¨ gi·ªëng b·∫°n ƒë·ªùi b√™n em.\n" +
          "Qu√° kh·ª© c·ªßa em anh ch∆∞a t·ª´ng ƒë∆∞·ª£c tham d·ª± nh∆∞ng t∆∞∆°ng lai s√°nh b∆∞·ªõc b√™n em anh nh·∫•t ƒë·ªãnh s·∫Ω tham gia.\n" +
          "M√¨nh c√πng nhau tr·∫£i qua nh·ªØng ng√†y h·∫°nh ph√∫c, kh·ªï ƒëau v√† ch·ªâ mong k·∫øt th√∫c l√† th√°ng ng√†y an y√™n b√™n nhau.\n" +
          "Anh y√™u em nhi·ªÅu l·∫Øm!!"
        );
      }, 800);
    }
  </script>
</body>
</html>
